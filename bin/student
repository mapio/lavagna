#!/usr/bin/env python

from os import getuid
from platform import node
from pwd import getpwuid
from urllib import urlencode
from urllib2 import urlopen
from webbrowser import open_new
from sys import argv

student = argv[ 1 ] if len( argv ) >= 2 else getpwuid( getuid() ).pw_gecos
location = argv[ 2 ] if len( argv ) >= 3 else node()
host = argv[ 3 ] if len( argv ) == 4 else 'hal.silab.di.unimi.it:8000'

data = urlencode( { 'student': student, 'location': location } ) 
token = urlopen( 'http://{0}/get_token'.format( host ), data ).read()

open_new( 'http://{0}/s/{1}'.format( host, token ) )
