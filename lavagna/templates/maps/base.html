{% extends "layout.html" %}
{% block script %}
var student = new Object();
$( document ).ready( function () {
	var source = new EventSource( '/stream/infos' );
	source.onmessage = function( e ) {
		infos = e.data.split( '@' );
		console.log( infos );
		elem = document.getElementById( infos[ 1 ] );
		if ( elem ) {
			student[ infos[ 1 ] ] = infos[ 0 ];
			elem.style.background = 'green';
		}
	};
	$( 'td' ).mousemove( function ( event ) {
		if ( $(this)[0].id ) {
			info = student[ $(this)[0].id ];
			if ( info ) {
				$( '#tooltip' )[ 0 ].innerHTML = info;
				$( '#tooltip' ).css( {
				    top: event.pageY + 5 + 'px',
					left: event.pageX + 5 + 'px'
				} ).show();
			}
		}
	});
	$( 'td' ).mouseleave( function () {
		$( '#tooltip' ).hide();
	});
} );
{% endblock %}
{% block body %}
<div id="tooltip">&nbsp;</div>
{% block map %}{% endblock %}
{% endblock %}
